Overview
========

This is a set of python scripts and iPython notebooks that analyze voting data
in Durham County, NC.

Setup
=====

1. Install GDAL (ogr2ogr utilities). On OSX this is as easy `brew install gdal`.
2. The `rtree` on OSX needs needs another library: `brew install spatialindex`.
3. Install a virtual environment and dependencies:

```bash
mkvirtualenv nc_election -p `which python3`
pip install -r requirements.txt
```

4. Run the notebook: `jupyter notebook`

Testing
=======

There are a few support python functions to clean up voter data; tests can be
run for them thusly:

```
pytest arcgis
```

Registered Voters
=================

Summaries of registered voters:

 * [County Analysis](./county-visualization.ipynb)
 * [Precinct Analysis](./precinct-visualization.ipynb)

Unregistered Addresses
======================

Summaries of the `data/durham_addresses.csv.gz` file can be viewed with the
iPython notebooks:

 * [Precinct Analysis](./precinct-addresses.ipynb)
 * County Analysis - TODO

**Generating Data**

The `data/durham_addresses.csv.gz` is generated by combining addresses the
Durham County GIS database of parcels, and the NCSBE voter logs. Together these
data sources are then run against a Durham County API that identifies apartment
numbers for an address, to produce a comprehensive list of all addresses in
Durham County, including apartments.

Since generating the dataset takes a couple hours, I've checked the latest
version of this CSV into the repository.

If you need to regenerate this dataset use the following instructions:

```
python export_parcels.py
python find_apartments.py
```

Notes
=====

Both the iPython notebooks and python scripts download a large number of
resources. In order to speed up the use of these scripts, they cache downloaded
files in the `data` directory.
